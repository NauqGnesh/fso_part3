(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{24:function(e,n,t){},43:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t(2),a=t.n(c),o=t(17),u=t.n(o),i=(t(24),t(8)),l=t(18),s=t(3),d=t(5),j=t.n(d),b="/api/persons",f=function(){return j.a.get(b).then((function(e){return e.data}))},h=function(e){return j.a.post(b,e).then((function(e){return e.data}))},O=function(e,n){return j.a.put("".concat(b,"/").concat(e),n).then((function(e){return e.data}))},m=function(e){return j.a.delete("".concat(b,"/").concat(e)).then((function(e){return e.data}))},x=function(e){var n=e.text;return Object(r.jsx)("h2",{children:n})},p=function(e){var n=e.text,t=e.handler;return Object(r.jsx)("div",{children:Object(r.jsx)("button",{onClick:t,children:n})})},v=function(e){var n=e.text,t=e.value,c=e.handler;return Object(r.jsxs)("div",{children:[n,": ",Object(r.jsx)("input",{value:t,onChange:c})]})},g=function(e){return Object(r.jsxs)("div",{children:[e.obj.name," ",e.obj.number,Object(r.jsx)(p,{text:"delete",handler:e.deleteHandler(e.obj)})]})},w=function(e){return Object(r.jsxs)("form",{children:[Object(r.jsx)(v,{text:"name",value:e.newName,handler:e.inputHandler("name")}),Object(r.jsx)(v,{text:"number",value:e.newNumber,handler:e.inputHandler("number")}),Object(r.jsx)(p,{text:"add",handler:e.buttonHandler})]})},H=function(e){var n=e.message,t=e.type;return null===n?null:t(n)},y=function(e){return Object(r.jsxs)("div",{children:[Object(r.jsx)(x,{text:"Phonebook"}),Object(r.jsx)(H,{message:e.errorMessage,type:e.messageType}),Object(r.jsx)(v,{text:"filter shown with",value:e.filter,handler:e.inputHandler("filter")}),Object(r.jsx)(x,{text:"add a new"}),Object(r.jsx)(w,{newName:e.newName,inputHandler:e.inputHandler,buttonHandler:e.buttonHandler}),Object(r.jsx)("h2",{children:"Numbers"}),e.persons.filter((function(n){return new RegExp(e.filter,"i").test(n.name)})).map((function(n){return Object(r.jsx)(g,{obj:n,deleteHandler:e.deleteHandler},n.name)}))]})},N=function(){var e=Object(c.useState)([]),n=Object(s.a)(e,2),t=n[0],a=n[1],o=Object(c.useState)(""),u=Object(s.a)(o,2),d=u[0],j=u[1],b=Object(c.useState)(""),x=Object(s.a)(b,2),p=x[0],v=x[1],g=Object(c.useState)(""),w=Object(s.a)(g,2),H=w[0],N=w[1],k=Object(c.useState)(null),S=Object(s.a)(k,2),D=S[0],E=S[1],M=Object(c.useState)(!1),C=Object(s.a)(M,2),J=C[0],P=C[1];Object(c.useEffect)((function(){console.log("effect"),f().then((function(e){console.log("promise fulfilled"),a(e),console.log(t)}))}),[]);return Object(r.jsx)("div",{children:Object(r.jsx)(y,{newName:d,inputHandler:function(e){switch(e){case"name":return function(e){return j(e.target.value)};case"number":return function(e){return v(e.target.value)};case"filter":return function(e){return N(e.target.value)};default:console.log("invalid argument")}},buttonHandler:function(e){e.preventDefault();var n=t.filter((function(e){return e.name===d}));if(0===n.length)!function(){var e={name:d,number:p};h(e).then((function(n){a([].concat(Object(l.a)(t),[n])),E("Added ".concat(e.name)),P(!0)})).catch((function(e){console.log(e.response.data),E("".concat(e.response.data.error)),P(!1)}))}();else{var r=n[0];window.confirm("".concat(d," is already added to phonebook, replace the old number with a new one?"))&&O(r.id,Object(i.a)(Object(i.a)({},r),{},{number:p})).then((function(e){return a(t.map((function(n){return n.id!==r.id?n:e})))})).catch((function(e){console.log(e)})),E("Updated contact details of ".concat(r.name)),P(!0)}j(""),v("")},deleteHandler:function(e){return function(){if(window.confirm("Delete ".concat(e.name))){var n=!0;console.log(e),m(e.id).catch((function(e){console.log(e),n=!1,E("Person was already deleted"),P(!1)})).finally((function(){n&&(a(t.filter((function(n){return n.id!==e.id}))),E("Deleted ".concat(e.name)),P(!1))}))}}},persons:t,errorMessage:D,messageType:function(e){return console.log(J),J?Object(r.jsx)("div",{className:"error success",children:e}):Object(r.jsx)("div",{className:"error",children:e})},filter:H})})};u.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(N,{})}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.c3fad466.chunk.js.map